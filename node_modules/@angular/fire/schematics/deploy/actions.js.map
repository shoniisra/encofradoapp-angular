{"version":3,"file":"actions.js","sourceRoot":"","sources":["../../../../src/schematics/deploy/actions.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,yDAAmF;AAGnF,SAA8B,MAAM,CAClC,aAA4B,EAC5B,OAAuB,EACvB,WAAmB,EACnB,WAAmB,EACnB,eAAwB;;QAExB,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,IAAI,KAAK,CAAC,0DAA0D,CAAC,CAAC;SAC7E;QAED,MAAM,aAAa,CAAC,KAAK,EAAE,CAAC;QAE5B,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YACnB,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QAED,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,OAAO,CAAC,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC;QAE/D,MAAM,GAAG,GAAG,MAAM,OAAO,CAAC,cAAc,CAAC,kCAAsB,CAAC,WAAW,CAAC,CAAC,CAAC;QAC9E,MAAM,GAAG,CAAC,MAAM,CAAC;QAEjB,IAAI;YACF,MAAM,aAAa,CAAC,GAAG,CAAC,eAAe,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE,CAAC,CAAC;SACxE;QAAC,OAAO,CAAC,EAAE;YACV,MAAM,IAAI,KAAK,CAAC,mCAAmC,eAAe,GAAG,CAAC,CAAC;SACxE;QAED,IAAI;YACF,MAAM,OAAO,GAAG,MAAM,aAAa,CAAC,MAAM,CAAC;gBACzC,IAAI,EAAE,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,OAAO;gBACzC,GAAG,EAAE,WAAW;aACjB,CAAC,CAAC;YACH,OAAO,CAAC,MAAM,CAAC,IAAI,CACjB,mDACE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAC9B,mBAAmB,CACpB,CAAC;SACH;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;SACzB;IACH,CAAC;CAAA;AAzCD,yBAyCC","sourcesContent":["import { BuilderContext, targetFromTargetString } from \"@angular-devkit/architect\";\nimport { FirebaseTools } from \"../interfaces\";\n\nexport default async function deploy(\n  firebaseTools: FirebaseTools,\n  context: BuilderContext,\n  projectRoot: string,\n  buildTarget: string,\n  firebaseProject?: string,\n) {\n  if (!firebaseProject) {\n    throw new Error(\"Cannot find firebase project for your app in .firebaserc\");\n  }\n\n  await firebaseTools.login();\n\n  if (!context.target) {\n    throw new Error(\"Cannot execute the build target\");\n  }\n\n  context.logger.info(`ðŸ“¦ Building \"${context.target.project}\"`);\n\n  const run = await context.scheduleTarget(targetFromTargetString(buildTarget));\n  await run.result;\n\n  try {\n    await firebaseTools.use(firebaseProject, { project: firebaseProject });\n  } catch (e) {\n    throw new Error(`Cannot select firebase project '${firebaseProject}'`);\n  }\n\n  try {\n    const success = await firebaseTools.deploy({\n      only: \"hosting:\" + context.target.project,\n      cwd: projectRoot\n    });\n    context.logger.info(\n      `ðŸš€ Your application is now available at https://${\n        success.hosting.split(\"/\")[1]\n      }.firebaseapp.com/`\n    );\n  } catch (e) {\n    context.logger.error(e);\n  }\n}\n"]}